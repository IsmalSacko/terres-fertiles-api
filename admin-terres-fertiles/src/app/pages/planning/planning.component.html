<div *ngIf="!loading && !error" class="container-fluid planning-container mt-5 page-with-intense-plants standard-page-content">
  <div class="planning-table">

    <div class="header-row">
      <div class="corner-cell">M√©langes</div>

      <div *ngFor="let month of months" class="month-section">
        <div class="month-name">{{ month }} {{ currentYear }}</div>

        <!-- Ligne des semaines avec jours inclus -->
        <div class="week-row">
          <div *ngFor="let week of weeksInMonth[month]" class="week-cell">
            <div class="week-label">S{{ week }}</div>
            <div class="days-inside-week">
          <span *ngFor="let day of daysInWeekMonth[month][week]" class="day-item">
            {{ day }}
          </span>
            </div>
          </div>
        </div>
      </div>
    </div>


    <!-- Lignes pour chaque plateforme -->
    <div *ngFor="let plateforme of getAllMelangesDisponibles()"  class="plateforme-row">
      <div  class="plateforme-name">{{ plateforme }} </div>


      <div *ngFor="let month of months" class="month-section">
        <div class="week-row">
          <div *ngFor="let week of weeksInMonth[month]"

               class="week-cell clickable"
               (click)="onCellClick(plateforme, week, month)"
               (mouseenter)="onCellHover(plateforme, week, month)"
               (mouseleave)="onCellLeave()">

            <span *ngIf="getNote(plateforme, week, month)" [class]="getNoteClass(plateforme, week, month)">
              {{ getNote(plateforme, week, month) }}
            </span>

            <!-- Tooltip √©tendu -->
            <div *ngIf="hoveredIntervention &&
                        hoveredIntervention.melange === plateforme &&
                        hoveredIntervention.week === week &&
                        hoveredIntervention.month === month"

                 class="hover-info">

              <strong>M√©lange :</strong> {{ hoveredIntervention.melange }}<br>
              <strong>Semaine :</strong> S{{ hoveredIntervention.week }}<br>
              <strong>Mois :</strong> {{ hoveredIntervention.month }}<br>
              <strong>Note :</strong> {{ hoveredIntervention.note }}<br>
              <strong>Statut :</strong> {{ hoveredIntervention.statutLabel || 'N/A' }}<br>
              <strong>Date :</strong> {{ hoveredIntervention.date || 'N/A' }}<br>
              <strong>Responsable :</strong> {{ hoveredIntervention.responsable || 'N/A' }}<br>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
  
  <!-- L√©gende des statuts -->
  <div class="status-legend mt-3">
    <h6>L√©gende des statuts :</h6>
    <div class="legend-items">
      <span class="legend-item">
        <span class="legend-color note-planned"></span>
        Planifi√© üóìÔ∏è
      </span>
      <span class="legend-item">
        <span class="legend-color note-active"></span>
        En cours‚è≥
      </span>
      <span class="legend-item">
        <span class="legend-color note-done"></span>
        Termin√© <span class="done-icon">‚úÖ</span>
      </span>
    </div>
  </div>
  
  <!-- S√©lecteur d'ann√©e en bas -->
  <div class="year-selector mt-4">
    <label for="year-select">Ann√©e :</label>
    <select [(ngModel)]="currentYear" (change)="onYearChange()" id="year-select">
      <option *ngFor="let y of years" [ngValue]="y">{{ y }}</option>
    </select>
  </div>
</div>


<div *ngIf="loading">Chargement en cours...</div>
<div *ngIf="error">{{ error }}</div>
