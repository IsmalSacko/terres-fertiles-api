/* Police/échelle proches d'Excel */
.fiche-detail-container {
  position: relative;
  top: 70px;  
  font-size: 12px;
  color: #000;
  /* utiliser des marges plutôt que position/top pour garder le flux normal */
  padding: 20px;
  box-sizing: border-box;
  max-width: 1250px; /* limite la largeur pour centrer le contenu sans occuper tout l'écran */
  margin: 20px auto; /* centre horizontalement avec un peu d'espace vertical */
}
.btn-group { margin-left: 0%; padding: 8px; width: 20% !important; box-sizing: border-box;}

/* Grille 3 colonnes : logo | centre | droite */
.fiche-header {
  display: grid;
  grid-template-columns: 90px 1fr 420px; /* adapte la 3e colonne si besoin */
  align-items: stretch;
  border: 1px solid #000;
  border-bottom: 0; /* sera refermé par les tables */
}

/* LOGO */
.logo {
  display: flex;
  align-items: flex-start;
  justify-content: center;
  border-right: 1px solid #000;
  font-weight: 700;
  font-size: 22px;
  padding-top: 6px;
}

.logo img {
  display: block;
  width: 72px;
  height: 72px;
  max-width: 100%;
  object-fit: contain;
  padding: 6px;
}

/* Colonne centrale : empiler 2 tables qui se touchent */
.header-main {
  display: flex;
  flex-direction: column;
}
/* Base Excel pour toutes les tables */
table.excel {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
  border: 1px solid #000;
}

table.excel th,
table.excel td {
  border: 1px solid #000;
  padding: 6px 8px;
  vertical-align: middle;
  word-wrap: break-word;
}

/* Titre */
.main-table .title {
  text-align: center;
  font-weight: 700;
  background: #f2f2f2;
  font-size: 14px;
  padding: 8px 6px;
}

/* Étiquettes/valeurs */
.label { white-space: normal; }

.center { text-align: center; }
.big { font-size: 18px; }

/* Supprimer la redondance de bordure entre les deux tables centrales */
.info-table.no-top-border { border-top: 0; }
.info-table.no-top-border tr:first-child td,
.info-table.no-top-border tr:first-child th {
  border-top: 0;
}

/* Colonne droite */
.right-column {
  border-left: 1px solid #000; /* jointure nette avec le centre */
}
.right-table { height: 100%; }
.right-table .r-label { font-weight: 600; }
.right-table .r-val { text-align: left; }

/* Harmonisation visuelle Excel */
.main-table .label,
.info-table .label,
.right-table .r-label {
  background: #fff; /* laisse blanc comme ta capture */
}

/* Impression A4 propre */
@media print {
  @page { size: A4 portrait; margin: 12mm; }
  .actions { display: none !important; }
  .fiche-header { break-inside: avoid; }
  /* évite les différences d'épaisseur à l'impression */
  table.excel th, table.excel td { padding: 5px 7px; }
}

/* Print-specific: force table full width, remove scrollbars and avoid clipped borders */
@media print {
  .horizon-table-wrapper { overflow: visible !important; padding: 70x !important; }
  .horizon-table.full { width: 100% !important; table-layout: fixed !important; display: table !important; margin: 0 auto !important; }
  .horizon-table.full th, .horizon-table.full td { page-break-inside: avoid !important; }
  .horizon-table.full thead { display: table-header-group; }
  .horizon-table.full tfoot { display: table-footer-group; }
  /* ensure rotated headers print correctly */
  .rotate-vertical, .horizon-table.full thead th.vertical { writing-mode: vertical-rl; transform: rotate(180deg); }
}

/* Section Horizons */
.pdf-horizons { margin-top: 28px; }
.horizon-table-wrapper { overflow: hidden; }
.horizon-table.full { width: 100%; max-width: 100%; box-sizing: border-box; border-collapse: collapse; border: 1px solid #000; }
.horizon-table.full th, .horizon-table.full td { border: 1px solid #000; padding: 6px; box-sizing: border-box; }
.horizon-table.full thead th { background: #f2f2f2; text-align: center; font-weight: 700; }
.horizon-table.full thead th.vertical {
  writing-mode: vertical-rl;
  transform: rotate(180deg);
  padding: 6px 4px;
  width: 36px;
}


.horizon-table.full td.echant { width: 80px; text-align: center; }
.rotate-vertical { writing-mode: vertical-rl; transform: rotate(180deg); text-align: center; vertical-align: middle; padding: 6px 4px; }

/* Ensure td content doesn't overflow when rotated */
.horizon-table.full td.rotate-vertical { height: 120px; white-space: nowrap; overflow: hidden; }

/* Actions column: visible on large screens, hidden on mobile/tablet */
.horizon-table.full td.desktop-actions-col,
.horizon-table.full th.desktop-actions-col { display: table-cell; }

/* Hide horizon-actions div on large screens */
.horizon-actions { display: none; }

/* Print button area (visible on screen, hidden on print by existing rule) */
.actions { margin-top: 18px; display: flex; gap: 12px; }
/* style any button inside .actions (Angular Material buttons are styled via mat-raised-button attribute) */
.actions button, .actions [mat-raised-button] { background: #1976d2; color: #fff; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; }
.actions button:hover, .actions [mat-raised-button]:hover { background: #165fa8; }

/* ================= Responsive Tablette (>=600px et <=1024px) ================= */
@media (max-width: 1024px) {
	.fiche-detail-container { padding: 16px; max-width: 100%; }
	.fiche-header { grid-template-columns: 70px 1fr 300px; }
	.logo { font-size: 18px; }
	.logo img { width: 50px; height: 50px; }
	table.excel th, table.excel td { padding: 5px 6px; font-size: 12px; }
	.main-table .title { font-size: 12px; }
	.big { font-size: 16px; }
	.horizon-table.full th, .horizon-table.full td { padding: 4px; font-size: 11px; }
  .horizon-table.full td.wide { width: 420px; }
  .horizon-table.full td.desktop-actions-col,
  .horizon-table.full th.desktop-actions-col { display: none; }
  .horizon-actions { display: flex; }
}

/* ================= Responsive Mobile (<=600px) ================= */
@media (max-width: 600px) {
	.fiche-detail-container { padding: 12px 8px; top: 40px; }
	.fiche-header { 
		grid-template-columns: 1fr;
		grid-template-areas:
			'logo'
			'main'
			'right';
	}
	.logo { grid-area: logo; border-right: none; border-bottom: 1px solid #000; justify-content: flex-start; font-size: 16px; }
	.header-main { grid-area: main; }
	.right-column { grid-area: right; border-left: none; border-top: 1px solid #000; }
	table.excel { display: block; width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }
	table.excel th, table.excel td { padding: 4px 5px; font-size: 11px; word-break: break-word; hyphens: auto; }
	.main-table .title { font-size: 11px; }
	.big { font-size: 14px; }
	.horizon-table-wrapper { overflow-x: auto; -webkit-overflow-scrolling: touch; }
	.horizon-table.full { display: block;  }
  .btn-group { margin-left: 10%; padding: 8px; width: 80% !important; box-sizing: border-box;}
	.photo-grid { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 8px; }
	.photo-block img { height: 100px; }
	.actions { flex-direction: column; gap: 8px; }
	.actions button, .actions [mat-raised-button] { width: 100%; }
  .horizon-table.full td.wide { width: 420px; }
  .pdf-horizons .d-flex { flex-direction: column; gap: 12px; }
  .pdf-horizons button { width: 100%; }
}

/* ================= Smartphones moyens (<=480px) ================= */
@media (max-width: 480px) {
	.fiche-detail-container { padding: 10px 6px; }
	.logo img { width: 44px; height: 44px; padding: 4px; }
	table.excel th, table.excel td { padding: 3.5px 4px; font-size: 10.5px; }
	.main-table .title { font-size: 10.5px; }
	.big { font-size: 13px; }
	.horizon-table.full th, .horizon-table.full td { padding: 3px; font-size: 10px; }
}

/* ================= Extra-compact (iPhone SE et petits écrans <=380px) ================= */
@media (max-width: 380px) {
	.fiche-detail-container { padding: 8px 4px; }
	.logo { font-size: 14px; }
	.logo img { width: 40px; height: 40px; padding: 4px; }
	table.excel th, table.excel td { padding: 3px 4px; font-size: 10px; }
	.main-table .title { font-size: 10px; padding: 6px 4px; }
	.big { font-size: 13px; }
	.horizon-table.full th, .horizon-table.full td { padding: 2px 3px; font-size: 9px; }
	.photo-grid { grid-template-columns: 1fr; }
}

/* Forcer l'affichage vertical des en-têtes sur tous les écrans */
.horizon-table.full thead th.vertical {
  writing-mode: vertical-rl !important;
  transform: rotate(180deg) !important;
  padding: 6px 4px !important;
  width: 36px !important;
  white-space: nowrap;
}

/* Photos grid */
.photo-page { margin-top: 22px; }
.photo-debug { margin-bottom: 8px; color: #333; }
.photo-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 12px;
}
.photo-block {
  border: 1px solid #ddd;
  padding: 6px;
  background: #fff;
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.photo-block img {
  width: 100%;
  height: 140px; /* fixed thumbnail height */
  object-fit: cover; /* important to crop images cleanly */
  display: block;
  border: 1px solid #ccc;
  border-radius: 3px;
}
.photo-block .caption {
  margin-top: 6px;
  font-size: 12px;
  color: #333;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap; /* prevent long URLs from wrapping */
}

/* Print: larger images with page breaks per photo-group if desired */
@media print {
  .photo-grid { grid-template-columns: repeat(2, 1fr); gap: 8px; }
  .photo-block img { height: 220px; }
  .photo-block { page-break-inside: avoid; }
}
