<div class="container form-container">
	<form (ngSubmit)="savePhoto()" #photoForm="ngForm" class="mat-elevation-z2 photo-form">
		<h2>Ajouter une photo d'horizon</h2>
		<mat-form-field appearance="outline" class="full-width">
			<mat-label>Type de photo</mat-label>
			<mat-select required name="type_photo" [(ngModel)]="photo.type_photo">
				<mat-option value="environnement">Environnement</mat-option>
				<mat-option value="profil">Profil</mat-option>
				<mat-option value="horizon">Horizon</mat-option>
				<mat-option value="sondage">Sondage</mat-option>
				<mat-option value="autre">Autre</mat-option>
			</mat-select>
		</mat-form-field>
		<mat-form-field appearance="outline" class="full-width">
			<mat-label>Description</mat-label>
			<textarea matInput name="description" [(ngModel)]="photo.description"></textarea>
		</mat-form-field>
			<!-- Champ fichier en dehors du mat-form-field -->
			<label for="image">Image</label>
			<input type="file" name="image" id="image" (change)="onFileChange($event)">
		<button mat-raised-button color="primary" type="submit" [disabled]="loading || !photoForm.form.valid">Enregistrer la photo</button>
			<div *ngIf="loading">
				<mat-progress-bar mode="indeterminate"></mat-progress-bar>
			</div>
			<div *ngIf="success" style="display:flex;align-items:center;gap:8px;margin-top:8px;">
				<mat-icon color="primary">check_circle</mat-icon>
				<span>Photo enregistrée</span>
			</div>
			<div *ngIf="error">
				<div class="error">{{ error }}</div>
			</div>
	</form>

		<!-- Liste des photos créées récemment -->
		<div *ngIf="createdPhotos.length > 0" class="created-photos">
			<h3>Photos enregistrées</h3>
			<div class="photos-grid">
				<div *ngFor="let p of createdPhotos" class="photo-item">
					<img [src]="p.image || p.url || (p.image_url ? p.image_url : '')" alt="photo" />
					<div class="photo-desc">{{ p.description }}</div>
				</div>
			</div>
			<button mat-stroked-button color="primary" (click)="goToFicheList()">Liste des fiches</button>
		</div>
</div>
